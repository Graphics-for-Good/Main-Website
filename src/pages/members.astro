---
var usernames = []

await fetch(`https://database.graphics-for-good.com/getUsernames`)
    .then(res => res.json())
    .then(json => usernames = json.response)

var membersObj = {}

await fetch(`https://database.graphics-for-good.com/getAllMembers`)
    .then(res => res.json())
    .then(json => membersObj = json.response)

var members = []
usernames.forEach(u => members.push(membersObj[u]))

import Layout from '../layouts/Layout.astro'
import Hero from '../components/hero.astro'

import '../styles/pages/members.scss'
import '../styles/photos.scss'
---
<Layout title="Members">
    <main id="content">
        <Hero classItems="fullHeight">
            <ul id="menu">
                <h1>Club Members</h1>
                {
                    members.map((member) => {
                        var username = member.username
                        return (
                            <a href={
                                `/members/${username}`
                            }>
                                <li>
                                    {member.name}
                                    {
                                        !!member.role ? 
                                            <span id="tag">({member.role.name})</span>
                                        : ''
                                    }
                                </li>
                            </a>
                        )
                    })
                }
            </ul>
        </Hero>
    </main>
    <script is:inline src="/members.js"></script>
</Layout>