---
import defaultBio from './defaultBio.js'

const userData = {
  username: 'adarsh', 
  name: 'Adarsh Kumar <span id="tag">(Website Manager/Designer)</span>',
  pronunciation: false, //'Uh-da-r-sh',
  email: {
    g4g: true,
    dtech: {
      year: 25,
    },
  }, 
  pfp: {
    url: `/assets/members/adarsh/pfps/pfp.png`, 
    g4g: {
      sizes: [
        {
          ext: 'png',
          name: 'full', 
      }, 
      ],
    },
    google: 'AEdFTp7icI4wRK0FPsc17CnhxoQslGk8Pj8cUQo8a6S80w',
  },
  location: {
    city: 'Bay Area', 
    state: '',
  }, 
  bio: {
    w1: 'the',
    w2: 'for',
  }, 
  socials: [
    {
      url: 'https://RockGamerAK.com', 
      name: 'Website', 
    }, 
    {
      url: 'https://youtube.com/@RockGamerHub', 
      name: 'YouTube', 
    }, 
    {
      url: 'https://instagram.com/RockGamerAK', 
      name: 'Instagram', 
    }, 
    {
      url: 'https://threads.net/@RockGamerAK', 
      name: 'Threads', 
    }, 
    {
      url: 'https://X.com/@RockGamerAK', 
      name: 'Twitter', 
    }, 
    {
      url: 'https://tiktok.com/@RockGamerAK', 
      name: 'TikTok', 
    }, 
    {
      url: 'https://twitch.tv/RockGamerAK', 
      name: 'Twitch', 
    }, 
    {
      url: 'https://kick.com/RockGamerAK', 
      name: 'Kick', 
    }, 
    {
      url: 'https://discord.com/users/768273827549282305', 
      name: 'Discord'
    }, 
    // {
    //   url: 'https://instagram.com/W.Web.Wizards', 
    //   name: 'Instagram', 
    // }, 
    // {
    //   url: 'W_Web_Wizards', 
    //   name: 'Twitter', 
    // }, 
    {
      url: 'https://instagram.com/akumarrws', 
      name: 'Instagram', 
    }, 
    {
      url: 'https://threads.net/@akumarrws', 
      name: 'Threads', 
    }, 
    {
      url: 'https://instagram.com/akumar.transit', 
      name: 'Instagram', 
    }, 
    {
      url: 'https://instagram.com/akumar.photos', 
      name: 'Instagram', 
    }, 
    {
      url: 'https://X.com/akumarrws', 
      name: 'Twitter', 
    }, 
    {
      url: 'https://youtube.com/akumarrws', 
      name: 'YouTube', 
    }, 
    {
      url: 'https://tiktok.com/akumarrws', 
      name: 'TikTok', 
    }, 
    {
      url: 'https://discord.com/users/1097241365198409728', 
      name: 'Discord', 
    }, 
  ],
  portfolio: [
    {
      img: {
        element: 'img',
        path: 'IMG_4052.png'
      },
      capt: '<a href="https://parks.RockGamerAK.com">A website</a> that I made promoting saving parks!',
      desc: `Made by: <a href="/members/adarsh">Adarsh</a>`,
    },
    {
      img: {
        element: 'img',
        path: 'IMG_4069.png',
      },
      capt: '<a href="https://rockgamerak.wixsite.com/games/jeopardy">A Jeopardy! Game</a> that I made!',
      desc: `Made by: <a href="/members/adarsh">Adarsh</a>`,
    }
  ],
}

userData.nameNoTitle = userData.name
if (userData.nameNoTitle.includes('<')) {
  userData.nameNoTitle = userData.nameNoTitle.split('<')[0]
}

if (!!userData.email.g4g) {
  userData.email.address = `${userData.username}@graphics-for-good.com`
}
else {
  let uName = userData.name
  if (uName.includes('<')) {
    uName = uName.split('<')[0]
  }
  uName = uName.split(' ')
  userData.email.address = `${uName[0].split('')[0]}${uName[1]}${userData.email.dtech.year}`
}

userData.location.combined = `${userData.location.city}, ${userData.location.state}<BLAHBLAH>`
  .replace(', <BLAHBLAH>', '').replace('<BLAHBLAH>', '')

userData.location.mapLink = userData.location.combined
while (userData.location.mapLink.includes(' ')) {
  userData.location.mapLink = userData.location.mapLink.replace(' ', '+')
}
userData.location.mapLink = `https://www.google.com/maps/place/${userData.location.mapLink}`

userData.socials.forEach(function(social, i) {
  userData.socials[i].icon = `/assets/icons/${social.name.toLowerCase()}.svg`
})

if (!!userData.bio) {
  if (!!userData.bio.w1 && !!userData.bio.w2) {
    userData.bio.result = defaultBio(userData.name, userData.bio.w1, userData.bio.w2)
  }
  else if (!!userData.bio.w1) {
    userData.bio.result = defaultBio(userData.name, userData.bio.w1)
  }
  else if (!!userData.bio.w2) {
    userData.bio.result = defaultBio(userData.name, false, userData.bio.w2)
  }
  else {
    userData.bio.result = defaultBio(userData.name)
  }
}
else {
  userData.bio = {}
  userData.bio.result = defaultBio(userData.name)
}

if (userData.bio.result.includes('{pronunciation}')) {
  // if (!!userData.pronunciation) {
  //   userData.bio.result = userData.bio.result.replace('{pronunciation}', userData.pronunciation)
  // }
  // else {
    userData.bio.result = userData.bio.result.replace('{pronunciation}', '')
  // }
}

userData.portfolio.forEach(function(photo, i) {
  var path = ''
  var element = photo['img']['element']
  if (element !== 'iframe') {
    path = `/assets/members/${user}/portfolio/previews/${photo['img']['path'].replace('.svg', '.png')}`
  }
  else if (photo['img']['path'].endsWith('.pdf')) {
    path = `/assets/members/${user}/portfolio/previews/${photo['img']['path'].replace('.pdf', '.png')}`
  }
  else {
    path = photo['img']['path']
  }
                
  var capt = photo['capt']
  while (capt.includes('<a target="_blank" href="/')) {
    capt = capt.replace('<a target="_blank" href="/', '<a href="/')
  }
                
  var desc = photo['desc']
  while (desc.includes('<a target="_blank" href="/')) {
    desc = desc.replace('<a target="_blank" href="/', '<a href="/')
  }
                
  var name = photo['img']['path']
  
  var img = document.createElement('img')
  if (path === 'YouTube') {
    name = `https://www.youtube-nocookie.com/embed/${photo['img']['vid_id']}?rel=0`
    img.src = `https://img.youtube.com/vi/${photo['img']['vid_id']}/maxresdefault.jpg`
  }
  else {
    img.src = path
  }
  var tElement = document.querySelector('[tElement]')
  title = `${capt}. Click to enlarge!`.replace('..', '.').replace('!.', '!')
  title = title.split('<')
  title.forEach(function(t, i) {
    if (t.includes('>')) {
      t = t.split('>')[1]
      title[i] = t
    }
  })
  title = title.join('')
  userData.portfolio[i].html = `<img src="${path}" title="${title}" onclick="showItem(${name}, ${element}, ${capt}, ${desc}, 'p')"/>`
})

import Layout from '../../layouts/Layout.astro'

import '../../styles/pages/members.scss'
import '../../styles/photos.scss'
---
<Layout title="Members">
  <section id="content"></section>
  <main id="profile" class="profile">
    <section>
      <span id="pfp" style={`background-image: url('${userData.pfp.url}')`}></span>
      <h1 id="name">{userData.nameNoTitle}</h1>
      <a id="email" href={`mailto:${userData.email.address}`}>{userData.email.address}</a>
      <a id="location" href={userData.location.mapLink}>
        <div></div>
        <span>{userData.location.combined}</span>
      </a>
      <ul id="socials">
        {userData.socials.map((social) => (
          <li>
            <a href={social.url} target="_blank" style={`background-image: url('${social.icon}')`}></a>
          </li>
        ))}
      </ul>
      <p id="bio" set:html={userData.bio.result}></p>
      <h2>Portfilio</h2>
      <ul id="photos" style="height: auto; gap: 25px;">
        <li>
          {userData.portfolio.map((photo) => (
            photo.html
          ))}
        </li>
      </ul>
    </section>
  </main>
  <script is:inline>
    var isBeta = !!localStorage.getItem('isBeta')
    var hasAddedMemberInfo = false
    if (isBeta) hasAddedMemberInfo = true
  </script>
  <script is:inline src="/members.js"></script>
  <script is:inline src="/modal.js"></script>
</Layout>